<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Wallet</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">
<div class="container">
  <h3>Wallet for {{ current_user.name or current_user.phone }}</h3>
  <p>Balance: <b>{{ wallet.balance }} KSh</b></p>

  <h5>Deposit (M-Pesa STK Push)</h5>
  <form method="post" action="{{ url_for('wallet_deposit') }}">
    <div class="row g-2 mb-2">
      <div class="col-md-4">
        <label class="form-label">Amount (KSh)</label>
        <input name="amount" class="form-control" placeholder="e.g., 100" required>
      </div>
      <div class="col-md-4">
        <label class="form-label">Phone Number (2547...)</label>
        <input name="phone" class="form-control" placeholder="2547XXXXXXXX" value="{{ current_user.phone }}">
        <small class="form-text text-muted">
          You can change this if you want to pay from another number.
        </small>
      </div>
      <div class="col-md-4 d-flex align-items-end">
        <button class="btn btn-success w-100">Deposit via M-Pesa</button>
      </div>
    </div>
  </form>

  <hr>
  <h5>Transactions</h5>
  <table class="table table-sm table-striped">
    <thead>
      <tr>
        <th>Date</th>
        <th>Type</th>
        <th>Amount (KSh)</th>
        <th>Note</th>
      </tr>
    </thead>
    <tbody>
      {% for t in txs %}
      <tr>
        <td>{{ t.timestamp.strftime('%Y-%m-%d %H:%M') }}</td>
        <td>{{ t.type }}</td>
        <td>{{ t.amount }}</td>
        <td>{{ t.note }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <p><a href="{{ url_for('home') }}" class="btn btn-secondary btn-sm">Back to Home</a></p>
</div>
</body>
</html>

